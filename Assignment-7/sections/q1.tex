\section*{Problem 1}
\setcounter{section}{1}
\setcounter{equation}{0}

\textbf{Cayley-Rodrigues Relationships}:
Recall the Cayley parametrization of \( S O(3) \) from earlier assignment.
We can generalize it to higher orders as follows:
\[
    R=(I-\widehat{a})^{k}(I+\widehat{a})^{-k} \in S O(3)
\]
Here, \( a \in \mathbb{R}^{3} \) are the Cayley parameters.
Now answer the following,
\begin{enumerate}[label= (\alph*)]
    \item (Case \( k=1 \))
          Show that given \( R=e^{\widehat{\omega} \theta} \) for some unit vector \( \omega \) along the axis of rotation and angle \( \theta \), then \( a=-\omega \tan (\theta / 2) \).

          (Hint: Plug in the value of \( \widehat{a} \) and \( e^{\widehat{w} \theta} \) in LHS of \( R(I+\widehat{a})=I-\widehat{a} \) and verify that it matches the RHS.\@
          You may need to recall the properties of \( \widehat{\omega} \in \operatorname{so}(3) \))

          Furthermore, also prove below relationships:
          \[
              R=\frac{\left(1-a^{T} a\right) I+2 a a^{T}+2 \widehat{a}}{1+a^{T} a}, \quad \widehat{a}=\frac{R-R^{T}}{1+\operatorname{trace}(R)} .
          \]

          (Hint: For the first relation, substitute the value of \( \widehat{a} \) and simplify the expression for it to match with \( e^{\widehat{\omega} \theta} \).
          As for the second relation, simply use the first relation in RHS and show that it matches LHS, also recall that \( \operatorname{trace}(A+B)=\operatorname{trace}(A)+\operatorname{trace}(B) \))

          Using these, can we know what the vectors ``\( -a \)'' and ``\( a=0 \)'' represent?

    \item (Case \( k=2 \)) Now show that the rotation \( R \) corresponding to \( a \) can be computed from the formula
          \[
              R=I-4 \frac{1-a^{T} a}{\left(1+a^{T} a\right)^{2}} \widehat{a}+\frac{8}{\left(1+a^{T} a\right)^{2}} \widehat{a}^{2}
          \]

          (Hint: Since we don't start off with knowing the form of \( \widehat{a} \), try to prove that LHS is equal to RHS for \( R(I+\widehat{a})^{2}=(I-\widehat{a})^{2} \) by using the formula of \( e^{\widehat{\omega} \theta} \))

          Conversely, prove that given a rotation matrix \( R \), there exists a vector \( a \) which satisfies the above and can be obtained as \( a=-\omega \tan (\theta / 4) \), where \( \omega \) is the unit vector along the axis of rotation for \( R \), and \( \theta \) is the corresponding rotation angle.
          Is this solution unique or not?

          Finally, show that the angular velocity in the body frame obeys the following relation:
          \[
              \dot{a}=\frac{1}{4}\left(\left(1-a^{T} a\right) I+2 \widehat{a}+2 a a^{T}\right) \omega_{b} .
          \]

    \item For \( k \geq 2 \), explain what happens to the singularity at \( \pi \) that exists for the standard Cayley parameters \( (k=1) \).
          Also, discuss the relative advantages and disadvantages of choosing different \( k \).

    \item An attractive feature of the Cayley parameters is the simple form for the composition of two rotation matrices.
          If \( a_{1} \) and \( a_{2} \) denote the Cayley parameters for two rotations \( R_{1} \) and \( R_{2} \) respectively, then show that for \( R_{3}=R_{1} R_{2} \) we would have the corresponding \( a_{3} \) given by
          \[
              a_{3}=\frac{a_{1}+a_{2}+\left(a_{1} \times a_{2}\right)}{1-a_{1}^{T} a_{2}}
          \]

          Compare the number of arithmetic operations needed for multiplying two rotation matrices or two Cayley representations.
          Which requires the fewest arithmetic operations?

          [Extra]:

          Lastly, show that we can even find body frame and spatial frame angular velocities in a simple form like
          \[
              \omega_{s}=\frac{2}{1+\|a\|^{2}}(a \times \dot{a}+\dot{a}), \quad \omega_{b}=\frac{2}{1+\|a\|^{2}}(-a \times \dot{a}+\dot{a})
          \]

          (What would happen in the case when trace \( (R)=-1 \) or \( a_{1}^{T} a_{2}=1 \equiv \operatorname{trace}\left(R_{1} R_{2}\right)=-1 \)?
          Does everything fail, or can we still work around it?
          Maybe try deriving everything in terms of a variable \( s=\frac{a}{\sqrt{1+a^{T} a}} \) and see where it leads to \( \ldots \))
\end{enumerate}

\subsection*{Solution}

\subsubsection*{(a) Case \( k=1 \)}

Given \( R = e^{\widehat{\omega} \theta} \in SO(3) \) for some unit vector \( \omega \) along the axis of rotation and angle \( \theta \), we have to show that \( a = -\omega \tan(\theta / 2) \).
For this, we will first find the value of \( \widehat{a} \) and then substitute it in the equation \( R(I + \widehat{a}) \) to verify that it matches the RHS, as given in the hint.

From the Rodrigues formula, we have
\begin{equation*}
    R = e^{\widehat{\omega} \theta} = I + \widehat{\omega} \sin \theta + \widehat{\omega}^{2} (1 - \cos \theta)
\end{equation*}
Now, with \( a = -\omega \tan(\theta / 2) \), we have \( \widehat{a} = -\widehat{\omega} \tan(\theta / 2) \), which is clear to see based on the matrix representation of the hat operator.
Thus, we have
\begin{align*}
    \implies
    R(I + \widehat{a})
     & =
    (I + \widehat{\omega} \sin \theta + \widehat{\omega}^{2} (1 - \cos \theta))(I - \widehat{\omega} \tan(\theta / 2))
    \\ & =
    I + \widehat{\omega} \sin \theta + \widehat{\omega}^{2} (1 - \cos \theta) - \widehat{\omega} \tan(\theta / 2)
    \\ & \quad
    - \widehat{\omega}^{2} \sin \theta \tan(\theta / 2) - \widehat{\omega}^{3} (1 - \cos \theta) \tan(\theta / 2)
    \\ & =
    I + \widehat{\omega} \sin \theta + \widehat{\omega}^{2} (1 - \cos \theta) - \cancel{\widehat{\omega} \tan(\theta / 2)}
    \\ & \quad
    - \widehat{\omega}^{2} \sin \theta \tan(\theta / 2) + \cancel{\widehat{\omega} \tan(\theta / 2)} - \widehat{\omega} \cos \theta \tan(\theta / 2)
    \\ & =
    I + \widehat{\omega} \left[ \sin \theta - \cos \theta \tan(\theta / 2) \right] + \widehat{\omega}^{2} \left[(1 - \cos \theta) - \sin \theta \tan(\theta / 2) \right]
\end{align*}
where we've used the relation \( \widehat{\omega}^{3} = -\widehat{\omega} \), which was derived in the previous assignments.
[Seen in \( \hat{w}^{3}=-\|w\|^{2} \hat{w} \) for \( \hat{w} \in so(3) \)].

Now, from the half-angle formulas, we have
\begin{equation*}
    \tan (\theta / 2)
    =
    \frac{\sin \theta}{1 + \cos \theta}
    =
    \frac{1 - \cos \theta}{\sin \theta}
\end{equation*}
\begin{align*}
    \implies
    R(I + \widehat{a})
     & =
    I + \widehat{\omega} \left[ \sin \theta - \cos \theta \frac{\sin \theta}{1 + \cos \theta} \right] + \widehat{\omega}^{2} \left[\cancel{(1 - \cos \theta)} - \cancel{\sin \theta \tan(\theta / 2)} \right]
    \\ & =
    I + \widehat{\omega} \sin \theta \left[ 1 - \frac{\cos \theta}{1 + \cos \theta} \right]
    =
    I + \widehat{\omega} \sin \theta \left[ \frac{1 + \cancel{\cos \theta} - \cancel{\cos \theta}}{1 + \cos \theta} \right]
    \\ & =
    I + \widehat{\omega} \frac{\sin \theta}{1 + \cos \theta}
    =
    I + \widehat{\omega} \tan(\theta / 2)
    \\ & =
    I - (-\widehat{\omega} \tan(\theta / 2))
    =
    (I - \widehat{a})
\end{align*}

Thus, we have shown that \( R(I + \widehat{a}) = I - \widehat{a} \implies \boxed{a = -\omega \tan(\theta / 2)} \) holds.

\vspace{1em}
Now, we want to prove the relationships,
\[
    R = \frac{(1 - a^{T} a) I + 2 a a^{T} + 2 \widehat{a}}{1 + a^{T} a}, \quad \widehat{a} = \frac{R - R^{T}}{1 + \operatorname{trace}(R)}
\]
