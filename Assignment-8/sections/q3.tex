\section*{Problem 3}
\setcounter{section}{3}
\setcounter{equation}{0}

\textbf{Passivity of Robot Dynamics:} \\
Let \( \mathcal{H}(\theta)=\mathcal{T}(\theta)+\mathcal{V}(\theta) \) be the total energy for a rigid robot.
Show that if \( \dot{\mathcal{M}}-2 \mathcal{C} \) is skew-symmetric, then energy is conserved, i.e., \( \dot{\mathcal{H}}=\dot{\theta}^{\top} \tau \).
(Basically total energy only changes due to the input work applied to the system.).

\subsection*{Solution}

Given that \( \mathcal{H}(\theta)=\mathcal{T}(\theta)+\mathcal{V}(\theta) \) is the total energy for a rigid robot, we have the kinetic energy \( \mathcal{T}(\theta) \) and the potential energy \( \mathcal{V}(\theta) \) as
\begin{align*}
    \mathcal{T}(\theta)
     & =
    \frac{1}{2} \dot{\theta}^{\top} \mathcal{M}(\theta) \dot{\theta}
    \\
    \implies
    \dot{\mathcal{T}}
     & =
    \frac{1}{2} \left(
    \ddot{\theta}^{\top} \mathcal{M}(\theta) \dot{\theta}
    +
    \dot{\theta}^{\top} \dot{\mathcal{M}}(\theta) \dot{\theta}
    +
    \dot{\theta}^{\top} \mathcal{M}(\theta) \ddot{\theta}
    \right)
    \\ & =
    \dot{\theta}^{\top} \mathcal{M}(\theta) \ddot{\theta}
    +
    \frac{1}{2}
    \dot{\theta}^{\top} \dot{\mathcal{M}}(\theta) \dot{\theta}
    \\
    \implies
    \dot{\mathcal{V}}
     & =
    \dot{\theta}^{\top} \frac{\partial \mathcal{V}(\theta)}{\partial \theta}
\end{align*}
The dynamics of a rigid robot are given by
\begin{equation*}
    \mathcal{M}(\theta) \ddot{\theta}
    +
    \mathcal{C}(\theta, \dot{\theta}) \dot{\theta}
    +
    \mathcal{G}(\theta)
    =
    \tau
\end{equation*}
where \( \mathcal{M}(\theta) \) is the inertia matrix, \( \mathcal{C}(\theta, \dot{\theta}) \) is the Coriolis matrix, \( \mathcal{G}(\theta) \) is the gravity matrix, and \( \tau \) is the control input.
Now, we have
\begin{align*}
    \implies
    \mathcal{M}(\theta) \ddot{\theta}
     & =
    \tau
    -
    \mathcal{C}(\theta, \dot{\theta}) \dot{\theta}
    -
    \mathcal{G}(\theta)
    \\
    \implies
    \dot{\mathcal{H}}
     & =
    \dot{\theta}^{\top} \mathcal{M}(\theta) \ddot{\theta}
    +
    \frac{1}{2}
    \dot{\theta}^{\top} \dot{\mathcal{M}}(\theta) \dot{\theta}
    +
    \dot{\theta}^{\top} \frac{\partial \mathcal{V}(\theta)}{\partial \theta}
    \\
     & =
    \dot{\theta}^{\top} \left( \tau - \mathcal{C}(\theta, \dot{\theta}) \dot{\theta} - \mathcal{G}(\theta) \right)
    +
    \frac{1}{2}
    \dot{\theta}^{\top} \dot{\mathcal{M}}(\theta) \dot{\theta}
    +
    \dot{\theta}^{\top} \frac{\partial \mathcal{V}(\theta)}{\partial \theta}
    \\ & =
    \dot{\theta}^{\top} \tau
    -
    \dot{\theta}^{\top} \mathcal{C}(\theta, \dot{\theta}) \dot{\theta}
    -
    \dot{\theta}^{\top} \mathcal{G}(\theta)
    +
    \frac{1}{2}
    \dot{\theta}^{\top} \dot{\mathcal{M}}(\theta) \dot{\theta}
    +
    \dot{\theta}^{\top} \frac{\partial \mathcal{V}(\theta)}{\partial \theta}
    \\
    \because
    \mathcal{G}(\theta)
     & =
    \frac{\partial \mathcal{V}(\theta)}{\partial \theta}
    \implies
    \dot{\theta}^{\top} \mathcal{G}(\theta)
    =
    \dot{\theta}^{\top} \frac{\partial \mathcal{V}(\theta)}{\partial \theta}
    \\
    \implies
    \dot{\mathcal{H}}
     & =
    \dot{\theta}^{\top} \tau
    -
    \dot{\theta}^{\top} \mathcal{C}(\theta, \dot{\theta}) \dot{\theta}
    -
    \cancel{\dot{\theta}^{\top} \mathcal{G}(\theta)}
    +
    \frac{1}{2}
    \dot{\theta}^{\top} \dot{\mathcal{M}}(\theta) \dot{\theta}
    +
    \cancel{\dot{\theta}^{\top} \frac{\partial \mathcal{V}(\theta)}{\partial \theta}}
    \\ & =
    \dot{\theta}^{\top} \tau
    -
    \dot{\theta}^{\top} \mathcal{C}(\theta, \dot{\theta}) \dot{\theta}
    +
    \frac{1}{2}
    \dot{\theta}^{\top} \dot{\mathcal{M}}(\theta) \dot{\theta}
    \\
    \therefore
    \dot{\mathcal{H}}
     & =
    \dot{\theta}^{\top} \tau
    +
    \frac{1}{2}
    \dot{\theta}^{\top} \left(
    \dot{\mathcal{M}}(\theta)
    -
    2 \mathcal{C}(\theta, \dot{\theta})
    \right)
    \dot{\theta}
\end{align*}
Now, for a skew-symmetric matrix \( A \), we have the property that \( x^\top A x = 0 \; \forall x \), since \( {(x^\top A x)}^\top = x^\top A^\top x = -x^\top A x \), since \( A^\top = -A \) and \( x^\top A x \) is a scalar, we have the result. \\
Therefore, \underline{if \( \dot{\mathcal{M}}-2 \mathcal{C} \) is skew-symmetric, then \( \dot{\mathcal{H}} = \dot{\theta}^{\top} \tau \)}, indicating that the total energy is conserved, i.e., the total energy only changes due to the input work applied to the system.
